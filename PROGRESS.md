Техническая спецификация — Ferum Customizations
1. План реализации проекта
Этап 1: Настройка инфраструктуры и базовой среды
[ ] Серверная инфраструктура **(Требуется ручное выполнение)**
[ ] Подготовить виртуальный или физический сервер с Ubuntu LTS.
[ ] Установить Docker и Docker Compose.
[ ] Настроить сетевое окружение и доступ по HTTPS.
[x] Развертывание ERPNext
[x] Создать docker-compose.yml с сервисами: frappe/erpnext, postgres, redis, nginx.
[x] Настроить .env с секретами (пароли, ключи).
[x] Запустить контейнеры и проверить корректность работы.
[ ] Создание сайта ERPNext
[?] Создать сайт erp.ferumrus.ru. **(Требуется подтверждение)**
[x] Установить кастомное приложение ferum_customs.
[ ] Настроить компанию, валюту и налоги. **(Требуется ручное выполнение в UI ERPNext)**
[x] Git и CI/CD
[x] Инициализировать Git-репозиторий.
[x] Настроить pre-commit хуки (linting, форматирование).
[x] Настроить GitHub Actions для автоматического запуска тестов.
Этап 2: Разработка модулей ERPNext
[ ] Проекты и Объекты обслуживания
[ ] Создать DocTypes: ServiceProject, ServiceObject, ProjectObjectItem.
[ ] Определить поля: детали контракта, клиент, SLA, сроки, сумма, статус.
[ ] Реализовать логику: проверка уникальности объектов, запрет на удаление активных объектов.
[ ] Сервисные заявки
[ ] Создать DocType: ServiceRequest.
[ ] Реализовать логику: строгий жизненный цикл (workflow), проверка SLA, эскалация, автозаполнение данных.
[ ] Отчеты о работах
[ ] Создать DocType: ServiceReport с дочерними таблицами.
[ ] Реализовать логику: авто-суммирование из списка работ, привязка к заявке при отправке.
[ ] Финансы
[ ] Создать DocType: Invoice.
[ ] Реализовать логику: статусы, синхронизация с Google Sheets.
[ ] Кадры и Зарплата
[ ] Создать DocType: PayrollEntryCustom.
[ ] Документы и Вложения
[ ] Создать DocType: CustomAttachment, реализовать интеграцию с Google Drive.
Этап 3: Роли, права доступа и безопасность
[ ] Роли
[ ] Создать роли: Администратор, Директор, Бухгалтер, Руководитель отдела, Менеджер проектов, Инженер, Офис-менеджер, Клиент.
[ ] Права доступа
[ ] Настроить матрицу прав доступа согласно спецификации.
[ ] Безопасность
[ ] Внедрить 2FA, настроить HTTPS, автоматизировать резервное копирование.
Этап 4: Внешний бэкенд, API и интеграции
[ ] Бэкенд на FastAPI
[ ] Разработать эндпоинты: /projects, /requests, /reports, /invoices.
[ ] Реализовать аутентификацию через JWT + 2FA и проверку ролей.
[ ] Интеграции с Google
[ ] Drive: загрузка/удаление файлов, хранение ссылок в ERPNext.
[ ] Sheets: автоматическая синхронизация счетов.
[ ] Боты
[ ] Разработать бота для Telegram (Aiogram).
[ ] (Опционально) Разработать бота для WhatsApp.
Этап 5: Мониторинг, аналитика и тестирование
[ ] Мониторинг
[ ] Интегрировать Sentry для отслеживания ошибок.
[ ] Интегрировать Prometheus для сбора метрик.
[ ] Аналитика
[ ] Создать кастомные отчеты в ERPNext.
[ ] Реализовать API для получения KPI ботом.
[ ] Тестирование
[ ] Написать Unit-тесты и E2E-тесты.
[ ] Staging-среда
[ ] Настроить отдельное окружение для тестирования перед релизами.
